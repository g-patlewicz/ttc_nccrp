from pathlib import Path
from rdkit import Chem


hpc_dict = {'Aflatoxin': {'COC1=C2C3=C(C(=O)OCC3)C(=O)OC2=C2C3C=COC3OC2=C1',
  'O=C1C=Cc2ccccc2O1',
  'O=c1ccc2ccccc2(o1)',
  '[#6]1[#6]2[#6]([#8][#6]1)[#8]c1c2c2c(c([#8][#6h3])c1)[#6]1=[#6]([#6](=[#8])[#8]2)[#6](=[#8])[#6][#6]1',
  '[#6]1[#6]2[#6]([#8][#6]1)[#8]c1c2c2c(c(c1)[O][CH3])[#6]1=[#6]([#6]([#8][#6][#6]1)=[#8])[#6](=[#8])[#8]2',
  '[#6]1[#6]2[#6]([#8][#6]=1)[#8]c1c2c2c(c(c1)[O][CH3])[#6]1=[#6]([#6]([#6][#6]1)=[#8])[#6](=[#8])[#8]2',
  '[#6]1[#6]2[#6]([#8][#6]=1)[#8]c1c2c2c(c(c1)[O][CH3])[#6]1=[#6]([#6]([#8][#6][#6]1)=[#8])[#6](=[#8])[#8]2'},
 'Azoxy': {'C=[$(N=N);!$(N=N=N);!$(N=NN)]',
  'CN=NO',
  'NN=O',
  '[$(C=[N+]=[N-]);!$(C=[N+]=[N-]=N);!$(C=[N+]=[N-]N)]',
  '[$([$([CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([CX4]([*!C])([*!C])([*!C]))[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([CX4]([*!C])([*!C])([*!C]))),$([CX4]([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))[*!C])][NX3+](=O)=[NX2][$([CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([CX4]([*!C])([*!C])([*!C]))[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([CX4]([*!C])([*!C])([*!C]))),$([CX4]([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))[*!C])]),$([$([CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([CX4]([*!C])([*!C])([*!C]))[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([CX4]([*!C])([*!C])([*!C]))),$([CX4]([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))[*!C])][NX3](=O)=[NX2][$([CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([CX4]([*!C])([*!C])([*!C]))[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([CX4]([*!C])([*!C])([*!C]))),$([CX4]([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))[*!C])]),$([$([CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([CX4]([*!C])([*!C])([*!C]))[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([CX4]([*!C])([*!C])([*!C]))),$([CX4]([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))[*!C])][NX3+]([O-])=[NX2][$([CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([CX4]([*!C])([*!C])([*!C]))[CX4]([*!C])([*!C])([*!C])),$([CX4]([*!C])([*!C])([*!C])[CX4]([*!C])([*!C])[CX4]([*!C])([CX4]([*!C])([*!C])([*!C]))),$([CX4]([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))([CX4]([*!C])([*!C])([*!C]))[*!C])])]',
  '[$([C,#1][NX2]=[NX2][C,#1]),$([CX3]=[NX2+]=N),$([CX3]=[NX2+]=[NX1-]),$([CX3-][NX2+]#[NX1]),$([CX3][NX2]#[NX1]),$(C[NX2]=N(=O)[*]),$(C[NX2]=[N+]([O-])[*])]',
  '[C,#1]N=[NX2][C,#1]'},
 'Benzidine': {'c2c(c1ccc(N)cc1)ccc(N)c2'},
 'Nitroso': {'N(c)(c)[NX2]=O',
  '[$([c][NX2]=O);r6;!$([c]([a]C)([a]C)[NX2]=O);!$([c]([c]C(=O)[OH])[NX2]=O);!$([c]([c]S(=O)(=O)[OH])[NX2]=O);!$([c]([a][c]S(=O)(=O)[OH])[NX2]=O);!$([c]([a][a][c]S(=O)(=O)[OH])[NX2]=O)]',
  '[$(c[NX2]=O);r5]',
  '[C,c]N[NX2;v3]=O',
  '[CH3,$([CH2]([NX3])[#6]),$([CH]([NX3])([#6])[#6])][NH,$(N([CX4])([NX3])[#6])][NX2]=O',
  '[CX4][NX3]([#6])[NX2]=O',
  '[a;!$(a(a[A;!#1])(a[A;!#1]));!$(aa[CX3](=O)[OX2H1]);!$(aa[SX4](=[OX1])(=[OX1])([O]));!$(aaa[SX4](=[OX1])(=[OX1])([O]));!$(aaaa[SX4](=[OX1])(=[OX1])([O]));!$(aaaaa[SX4](=[OX1])(=[OX1])([O]));!$(aaaaaa[SX4](=[OX1])(=[OX1])([O]))]!@[$([NX2]=O)]'}}


hpc_smarts = {k : [Chem.MolFromSmarts(s) for s in v] for k,v in hpc_dict.items()}


dlc_dict = {'biphenyl': {'[Cl,Br,F,I]c1ccc(cc1)!@c2ccc(cc2)[Cl,Br,F,I]',
  'c1cc(ccc1)c1ccccc1.[F,Br,Cl,#1].[F,Br,Cl,#1]',
  'c1cc(ccc1[!R]c2ccc(cc2)[Cl,Br,F,I])[Cl,Br,F,I]'},
 'dibenzodioxin': {'c1ccc2Oc3cc(ccc3(Oc2(c1)))[Cl,Br,F,I]',
  'c1ccc2Oc3ccccc3Oc2c1.[F,Br,Cl,#1].[F,Br,Cl,#1]'},
 'dibenzofuran': {'c1cccc2oc3ccccc3c12.[F,Br,Cl,#1].[F,Br,Cl,#1]'}}

dlc_smarts = {k:[Chem.MolFromSmarts(e) for e in v] for k,v in dlc_dict.items()}

op_dict = {'OPs': {'CP(=O)(C)O',
  'OP(=[O])([O,S])N[C&!R,#1]',
  'OP(=[SX1])([S])[O,C]',
  'SP(=O)(S)[S]',
  'SP(S)S',
  '[#1]OP(=[O])(O[#1])C*',
  '[#6]OP(=[SX1])([#6])O[#6]',
  '[O,S]P(=[O,SX])([O,S]C)[O,S]'},
 'carbamates': {'[NX3]([CX4&!R,#1,S])([CX4&!R,#1])C(=[O,S])[O,S][#6,N,#1]',
  '[NX3]([CX4,#1,S])([CX4,#1,S])C(=[S])[S-]'}}

opc_smarts = {k:[Chem.MolFromSmarts(e) for e in v] for k,v in op_dict.items()}
